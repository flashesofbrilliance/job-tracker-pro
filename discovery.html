<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Discovery Engine</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1a1a2e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Sushi Discovery">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png">
  
  <!-- Mobile Optimizations -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no">
  
  <!-- WebGL & Animation Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cannon.js/0.20.0/cannon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <div class="header-content">
        <div class="header-left">
          <h1 class="app-title"><i class="fas fa-compass"></i> Discovery Engine</h1>
        </div>
        <div class="header-actions">
          <button class="btn btn--outline btn--sm" id="refresh-btn"><i class="fas fa-sync"></i> Refresh</button>
          <a class="btn btn--secondary btn--sm" href="index.html"><i class="fas fa-home"></i> Back to App</a>
        </div>
      </div>
    </header>

    <!-- Neo-Contemporary Sushi Conveyor Belt -->
    <main class="sushi-discovery-main">
      
      <!-- Full-Width Conveyor Belt -->
      <section class="conveyor-belt-section">
        <div class="conveyor-belt-container">
          
          <!-- Tatami Mat Base -->
          <div class="tatami-base">
            
            <!-- White Oak Sushi Counter -->
            <div class="sushi-counter">
              
              <!-- Moving Conveyor Belt -->
              <div class="conveyor-track">
                <div class="conveyor-belt" id="conveyor-belt">
                  <!-- Sushi plates will move along this belt -->
                  <div class="sushi-plate active" id="sushi-stage">
                    <div class="sushi-piece">
                      <div class="sushi-emoji">üç£</div>
                      <div class="sushi-label-top">Loading...</div>
                      <div class="sushi-label-bottom">Preparing omakase...</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Control Interface -->
              <div class="atari-controls">
                <div class="control-hint">
                  <span class="key-hint">‚Üê</span> PASS
                  <span class="separator">|</span>
                  <span class="key-hint">‚Üí</span> GRAB
                  <span class="separator">|</span>
                  <span class="key-hint">SPACE</span> NEXT
                </div>
              </div>
              
            </div>
            
          </div>
          
        </div>
      </section>
      
      <!-- Centered Job Info Display -->
      <section class="job-info-section">
        <div class="job-display-container">
          
          <!-- 80s Atari-Style Info Panel -->
          <div class="atari-job-panel" id="job-card">
            
            <!-- Header Display -->
            <div class="atari-header">
              <div class="company-display">
                <span class="label">COMPANY:</span>
                <span class="value" id="card-company">LOADING...</span>
              </div>
              <div class="role-display">
                <span class="label">ROLE:</span>
                <span class="value" id="card-role">PREPARING...</span>
              </div>
            </div>
            
            <!-- Stats Grid -->
            <div class="atari-stats-grid">
              <div class="stat-block salary-block">
                <div class="stat-label">SALARY</div>
                <div class="stat-value" id="salary-value">$--</div>
              </div>
              
              <div class="stat-block fit-block">
                <div class="stat-label">FIT</div>
                <div class="stat-value fit-score" id="fit-score-value">--</div>
              </div>
              
              <div class="stat-block vibe-block">
                <div class="stat-label">VIBE</div>
                <div class="stat-value" id="vibe-value">üòê</div>
              </div>
              
              <div class="stat-block sector-block">
                <div class="stat-label">SECTOR</div>
                <div class="stat-value" id="sector-value">--</div>
              </div>
              
              <div class="stat-block location-block">
                <div class="stat-label">LOCATION</div>
                <div class="stat-value" id="location-value">--</div>
              </div>
            </div>
            
            <!-- Tags Display -->
            <div class="atari-tags-display">
              <div class="tags-label">TAGS:</div>
              <div class="tags-container" id="card-tags">
                <!-- Tags will be populated here -->
              </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="atari-action-bar">
              <button class="atari-btn reject-btn" id="reject-btn">
                <span class="btn-icon">‚Üê</span>
                <span class="btn-text">PASS</span>
              </button>
              <button class="atari-btn accept-btn" id="accept-btn">
                <span class="btn-icon">‚Üí</span>
                <span class="btn-text">GRAB</span>
              </button>
            </div>
            
          </div>
          
        </div>
      </section>
      
    </main>
    
    <!-- Collapsed Analytics Section -->
    <footer class="analytics-footer collapsed">
      <div class="analytics-toggle" onclick="toggleAnalytics()">
        <i class="fas fa-chart-line"></i>
        <span>Analytics</span>
        <i class="fas fa-chevron-up"></i>
      </div>
      <div class="analytics-content" id="analytics-content">
        <div class="analytics-grid">
          <div class="analytics-card">
            <h4>Learning Signals</h4>
            <div id="signals"></div>
          </div>
          <div class="analytics-card">
            <h4>Belt Analytics</h4>
            <div id="belt-analytics"></div>
          </div>
        </div>
      </div>
      <div id="recos" style="display: none;"></div>
    </footer>

    <div class="toast-container" id="toast-container"></div>
  </div>

  <script src="performance-manager.js"></script>
  <script src="metrics-framework.js"></script>
  <script src="discovery-core.js"></script>
  <script src="discovery.js"></script>
  
  <script>
    // Initialize performance and metrics frameworks
    const performanceManager = new MobilePerformanceManager();
    const uxMetrics = new UXMetricsFramework();
    
    // Enable metrics dashboard in development
    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
      document.getElementById('ux-metrics-dashboard').style.display = 'block';
    }
    
    console.log('üç£ Sushi Discovery PWA loaded with performance optimization and UX metrics');
    
    // Analytics toggle function
    function toggleAnalytics() {
      const footer = document.querySelector('.analytics-footer');
      const content = document.getElementById('analytics-content');
      const chevron = document.querySelector('.analytics-toggle .fa-chevron-up');
      
      footer.classList.toggle('collapsed');
      
      if (footer.classList.contains('collapsed')) {
        chevron.className = 'fas fa-chevron-up';
      } else {
        chevron.className = 'fas fa-chevron-down';
      }
    }
    
    // Make function globally available
    window.toggleAnalytics = toggleAnalytics;
  </script>
</body>
</html>

