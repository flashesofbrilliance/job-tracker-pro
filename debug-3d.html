<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Shoji Box Debug</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      background: #1a1a2e;
      color: white;
      font-family: monospace;
    }
    
    #debug-canvas {
      width: 800px;
      height: 600px;
      border: 2px solid #00ffff;
      border-radius: 8px;
      background: linear-gradient(135deg, #1a1a2e 0%, #0f3460 100%);
    }
    
    .debug-info {
      margin: 20px 0;
      padding: 10px;
      background: rgba(0, 255, 255, 0.1);
      border-radius: 4px;
    }
  </style>
  
  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
  <h1>üèÆ 3D Shoji Box Debug Test</h1>
  
  <div class="debug-info">
    <p>Status: <span id="status">Loading...</span></p>
    <p>Scene Objects: <span id="object-count">0</span></p>
    <p>Console: <span id="console-log">Check browser console for logs</span></p>
  </div>
  
  <canvas id="debug-canvas"></canvas>
  
  <script>
    console.log('üèÆ Starting 3D Shoji Box Debug Test...');
    
    // Simple test to see if our 3D scene works
    const canvas = document.getElementById('debug-canvas');
    const statusEl = document.getElementById('status');
    const objectCountEl = document.getElementById('object-count');
    
    let scene, camera, renderer;
    
    function init() {
      try {
        statusEl.textContent = 'Initializing...';
        
        // Scene
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x1a1a2e);
        
        // Camera
        const aspect = canvas.clientWidth / canvas.clientHeight;
        camera = new THREE.PerspectiveCamera(35, aspect, 0.1, 50);
        camera.position.set(0, 3, 8);
        camera.lookAt(0, 0, 0);
        
        // Renderer
        renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });
        renderer.setSize(canvas.clientWidth, canvas.clientHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        
        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(5, 10, 5);
        directionalLight.castShadow = true;
        scene.add(directionalLight);
        
        // Test objects
        createTestScene();
        
        // Start render loop
        animate();
        
        statusEl.textContent = 'Running ‚úÖ';
        objectCountEl.textContent = scene.children.length;
        
        console.log('‚úÖ 3D Scene initialized successfully!');
        
      } catch (error) {
        console.error('‚ùå Error initializing 3D scene:', error);
        statusEl.textContent = 'Error ‚ùå - Check console';
      }
    }
    
    function createTestScene() {
      console.log('üèÆ Creating test shoji box...');
      
      // White oak board
      const boardGeometry = new THREE.BoxGeometry(8, 0.3, 3);
      const boardMaterial = new THREE.MeshPhysicalMaterial({
        color: 0xf5f0e8,
        roughness: 0.7,
        metalness: 0.05
      });
      const board = new THREE.Mesh(boardGeometry, boardMaterial);
      board.position.set(0, 0.15, 0);
      board.castShadow = true;
      board.receiveShadow = true;
      scene.add(board);
      
      // Test sushi
      const sushiGeometry = new THREE.BoxGeometry(0.5, 0.3, 0.8);
      const sushiMaterial = new THREE.MeshPhysicalMaterial({
        color: 0xff6347,
        roughness: 0.3
      });
      const sushi = new THREE.Mesh(sushiGeometry, sushiMaterial);
      sushi.position.set(0, 0.5, 0);
      sushi.castShadow = true;
      scene.add(sushi);
      
      // Shoji frame
      const frameMaterial = new THREE.MeshPhysicalMaterial({
        color: 0x3d2b1f,
        roughness: 0.8
      });
      
      // Back wall
      const backWall = new THREE.Mesh(
        new THREE.PlaneGeometry(10, 6),
        new THREE.MeshPhysicalMaterial({
          color: 0xfaf7f0,
          roughness: 0.9
        })
      );
      backWall.position.set(0, 2, -4);
      backWall.receiveShadow = true;
      scene.add(backWall);
      
      console.log('‚úÖ Test scene created with', scene.children.length, 'objects');
    }
    
    function animate() {
      requestAnimationFrame(animate);
      
      // Simple rotation for the test sushi
      const sushi = scene.children.find(obj => obj.geometry && obj.geometry.type === 'BoxGeometry' && obj.position.y > 0.4);
      if (sushi) {
        sushi.rotation.y += 0.01;
        sushi.position.y = 0.5 + Math.sin(Date.now() * 0.001) * 0.05;
      }
      
      renderer.render(scene, camera);
    }
    
    // Start the test
    init();
    
    // Handle resize
    window.addEventListener('resize', () => {
      if (camera && renderer) {
        camera.aspect = canvas.clientWidth / canvas.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(canvas.clientWidth, canvas.clientHeight);
      }
    });
  </script>
</body>
</html>