<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Discovery Engine</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1a1a2e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Sushi Discovery">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png">
  
  <!-- Mobile Optimizations -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no">
  
  <!-- WebGL & Animation Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cannon.js/0.20.0/cannon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
  
  <style>
  /* Mise en Place System Styles */
  .mise-en-place-card {
    background: linear-gradient(135deg, rgba(139, 69, 19, 0.1), rgba(160, 82, 45, 0.1));
    border: 1px solid rgba(139, 69, 19, 0.3);
  }
  
  .prep-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }
  
  .prep-title {
    font-weight: bold;
    font-size: 16px;
    color: #8b4513;
  }
  
  .prep-score {
    font-weight: bold;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 14px;
  }
  
  .prep-score.excellent {
    background: rgba(0, 255, 0, 0.2);
    color: #00ff00;
  }
  
  .prep-score.good {
    background: rgba(255, 165, 0, 0.2);
    color: #ffa500;
  }
  
  .prep-score.needs-work {
    background: rgba(255, 0, 0, 0.2);
    color: #ff6b6b;
  }
  
  .prep-items {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    margin-bottom: 15px;
  }
  
  .prep-item {
    display: flex;
    align-items: center;
    padding: 6px;
    border-radius: 4px;
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.1);
    font-size: 12px;
    transition: all 0.3s ease;
  }
  
  .prep-item.completed {
    background: rgba(0, 255, 0, 0.1);
    border-color: rgba(0, 255, 0, 0.3);
    color: #00ff00;
  }
  
  .prep-icon {
    margin-right: 6px;
  }
  
  .prep-stats {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    opacity: 0.8;
    margin-bottom: 10px;
  }
  
  .prep-controls {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 4px;
  }
  
  .prep-btn {
    background: rgba(139, 69, 19, 0.3);
    border: 1px solid rgba(139, 69, 19, 0.5);
    color: #d4af37;
    padding: 4px 6px;
    border-radius: 4px;
    font-size: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .prep-btn:hover {
    background: rgba(139, 69, 19, 0.5);
    transform: translateY(-1px);
  }
  
  /* Knife Skills System Styles */
  .knife-skills-card {
    background: linear-gradient(135deg, rgba(47, 79, 79, 0.1), rgba(70, 130, 180, 0.1));
    border: 1px solid rgba(47, 79, 79, 0.3);
  }
  
  .skills-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }
  
  .skills-title {
    font-weight: bold;
    font-size: 16px;
    color: #2f4f4f;
  }
  
  .skill-level {
    font-weight: bold;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    text-transform: uppercase;
  }
  
  .skill-level.novice {
    background: rgba(128, 128, 128, 0.2);
    color: #888;
  }
  
  .skill-level.apprentice {
    background: rgba(0, 191, 255, 0.2);
    color: #00bfff;
  }
  
  .skill-level.chef {
    background: rgba(255, 140, 0, 0.2);
    color: #ff8c00;
  }
  
  .skill-level.master {
    background: rgba(255, 215, 0, 0.2);
    color: #ffd700;
  }
  
  .skills-metrics {
    margin-bottom: 15px;
  }
  
  .skill-metric {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 8px;
    font-size: 12px;
  }
  
  .metric-name {
    width: 70px;
    color: #ccc;
  }
  
  .metric-bar {
    flex: 1;
    height: 8px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    margin: 0 8px;
    overflow: hidden;
  }
  
  .metric-fill {
    height: 100%;
    background: linear-gradient(90deg, #00bfff, #1e90ff);
    transition: width 0.5s ease;
    border-radius: 4px;
  }
  
  .metric-value {
    width: 40px;
    text-align: right;
    color: #00bfff;
    font-weight: bold;
  }
  
  .mastery-badges {
    display: flex;
    gap: 4px;
    justify-content: center;
  }
  
  .mastery-badge {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: rgba(255, 215, 0, 0.2);
    border: 1px solid rgba(255, 215, 0, 0.3);
    font-size: 12px;
  }
  
  .mastery-badge.sniper {
    background: rgba(255, 0, 0, 0.2);
    border-color: rgba(255, 0, 0, 0.3);
  }
  
  .mastery-badge.lightning {
    background: rgba(255, 255, 0, 0.2);
    border-color: rgba(255, 255, 0, 0.3);
  }
  
  .mastery-badge.artisan {
    background: rgba(138, 43, 226, 0.2);
    border-color: rgba(138, 43, 226, 0.3);
  }
  
  /* Chef Advice Messages */
  .chef-quick-advice {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
    max-width: 300px;
    opacity: 0;
  }
  
  .chef-bubble {
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 10px 15px;
    border-radius: 15px;
    border: 1px solid rgba(255, 215, 0, 0.3);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .chef-emoji {
    font-size: 18px;
  }
  
  /* Skill Level Up Animation */
  .skill-level-up {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 2000;
    opacity: 0;
  }
  
  .level-up-content {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.95), rgba(255, 140, 0, 0.95));
    color: #000;
    padding: 30px;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    border: 3px solid #ffd700;
  }
  
  .level-up-header {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 15px;
    text-transform: uppercase;
  }
  
  .level-progression {
    font-size: 20px;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }
  
  .old-level {
    opacity: 0.6;
  }
  
  .new-level {
    font-weight: bold;
    color: #ff6b00;
  }
  
  .arrow {
    font-size: 24px;
  }
  
  .level-description {
    font-size: 14px;
    opacity: 0.8;
    font-style: italic;
  }
  
  /* Mastery Unlock Animation */
  .mastery-unlock {
    position: fixed;
    top: 30%;
    right: 20px;
    z-index: 1500;
    opacity: 0;
  }
  
  .mastery-content {
    background: linear-gradient(135deg, rgba(75, 0, 130, 0.95), rgba(138, 43, 226, 0.95));
    color: white;
    padding: 20px;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
    border: 2px solid #8a2be2;
  }
  
  .mastery-icon {
    font-size: 36px;
    margin-bottom: 10px;
  }
  
  .mastery-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 8px;
    text-transform: uppercase;
  }
  
  .mastery-desc {
    font-size: 12px;
    opacity: 0.9;
  }
  
  @media (max-width: 768px) {
    .prep-controls {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .prep-items {
      grid-template-columns: 1fr;
    }
    
    .chef-quick-advice {
      right: 10px;
      top: 10px;
      max-width: 250px;
    }
    
    .level-up-content {
      padding: 20px;
      margin: 20px;
    }
    
    .mastery-unlock {
      right: 10px;
    }
  }
  </style>
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <div class="header-content">
        <div class="header-left">
          <h1 class="app-title"><i class="fas fa-compass"></i> Discovery Engine</h1>
        </div>
        <div class="header-actions">
          <button class="btn btn--outline btn--sm" id="refresh-btn"><i class="fas fa-sync"></i> Refresh</button>
          <a class="btn btn--secondary btn--sm" href="index.html"><i class="fas fa-home"></i> Back to App</a>
        </div>
      </div>
    </header>

    <!-- Neo-Contemporary Sushi Conveyor Belt -->
    <main class="sushi-discovery-main">
      
      <!-- Full-Width Conveyor Belt -->
      <section class="conveyor-belt-section">
        <div class="conveyor-belt-container">
          
          <!-- Tatami Mat Base -->
          <div class="tatami-base">
            
            <!-- White Oak Sushi Counter -->
            <div class="sushi-counter">
              
              <!-- Moving Conveyor Belt -->
              <div class="conveyor-track">
                <div class="conveyor-belt" id="conveyor-belt">
                  <!-- Sushi plates will be dynamically added here -->
                </div>
                
                <!-- Decision Zone Indicator -->
                <div class="decision-zone">
                  <div class="decision-zone-label">DECISION ZONE</div>
                  <div class="time-indicator" id="time-indicator"></div>
                </div>
                
                <!-- Missed Opportunities Pile -->
                <div class="missed-pile" id="missed-pile">
                  <div class="pile-label">MISSED</div>
                  <div class="pile-count" id="pile-count">0</div>
                </div>
              </div>
              
              <!-- Control Interface -->
              <div class="atari-controls">
                <div class="control-hint">
                  <span class="key-hint">←</span> PASS
                  <span class="separator">|</span>
                  <span class="key-hint">→</span> GRAB
                  <span class="separator">|</span>
                  <span class="key-hint">SPACE</span> NEXT
                </div>
              </div>
              
            </div>
            
          </div>
          
        </div>
      </section>
      
      <!-- Centered Job Info Display -->
      <section class="job-info-section">
        <div class="job-display-container">
          
          <!-- 80s Atari-Style Info Panel -->
          <div class="atari-job-panel" id="job-card">
            
            <!-- Header Display -->
            <div class="atari-header">
              <div class="company-display">
                <span class="label">COMPANY:</span>
                <span class="value" id="card-company">LOADING...</span>
              </div>
              <div class="role-display">
                <span class="label">ROLE:</span>
                <span class="value" id="card-role">PREPARING...</span>
              </div>
            </div>
            
            <!-- Stats Grid -->
            <div class="atari-stats-grid">
              <div class="stat-block salary-block">
                <div class="stat-label">SALARY</div>
                <div class="stat-value" id="salary-value">$--</div>
              </div>
              
              <div class="stat-block fit-block">
                <div class="stat-label">FIT</div>
                <div class="stat-value fit-score" id="fit-score-value">--</div>
              </div>
              
              <div class="stat-block vibe-block">
                <div class="stat-label">VIBE</div>
                <div class="stat-value" id="vibe-value">😐</div>
              </div>
              
              <div class="stat-block sector-block">
                <div class="stat-label">SECTOR</div>
                <div class="stat-value" id="sector-value">--</div>
              </div>
              
              <div class="stat-block location-block">
                <div class="stat-label">LOCATION</div>
                <div class="stat-value" id="location-value">--</div>
              </div>
            </div>
            
            <!-- Tags Display -->
            <div class="atari-tags-display">
              <div class="tags-label">TAGS:</div>
              <div class="tags-container" id="card-tags">
                <!-- Tags will be populated here -->
              </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="atari-action-bar">
              <button class="atari-btn reject-btn" id="reject-btn">
                <span class="btn-icon">←</span>
                <span class="btn-text">PASS</span>
              </button>
              <button class="atari-btn accept-btn" id="accept-btn">
                <span class="btn-icon">→</span>
                <span class="btn-text">GRAB</span>
              </button>
            </div>
            
          </div>
          
        </div>
      </section>
      
    </main>
    
    <!-- Collapsed Analytics Section -->
    <footer class="analytics-footer collapsed">
      <div class="analytics-toggle" onclick="toggleAnalytics()">
        <i class="fas fa-chart-line"></i>
        <span>Analytics</span>
        <i class="fas fa-chevron-up"></i>
      </div>
      <div class="analytics-content" id="analytics-content">
        <div class="analytics-grid">
          <div class="analytics-card">
            <h4>Learning Signals</h4>
            <div id="signals"></div>
          </div>
          <div class="analytics-card">
            <h4>Belt Analytics</h4>
            <div id="belt-analytics"></div>
          </div>
          <div class="analytics-card mise-en-place-card">
            <h4>Daily Preparation</h4>
            <div id="preparation-status"></div>
            <div class="prep-controls">
              <button onclick="completePreparationItem('profile')" class="prep-btn">📝 Profile</button>
              <button onclick="completePreparationItem('research')" class="prep-btn">🔍 Research</button>
              <button onclick="completePreparationItem('network')" class="prep-btn">🤝 Network</button>
              <button onclick="completePreparationItem('skills')" class="prep-btn">⚡ Skills</button>
              <button onclick="completePreparationItem('intel')" class="prep-btn">📊 Intel</button>
              <button onclick="completePreparationItem('tools')" class="prep-btn">🔧 Tools</button>
            </div>
          </div>
          <div class="analytics-card knife-skills-card">
            <h4>Application Mastery</h4>
            <div id="knife-skills-status"></div>
          </div>
        </div>
      </div>
      <div id="recos" style="display: none;"></div>
    </footer>

    <div class="toast-container" id="toast-container"></div>
  </div>

  <script src="performance-manager.js"></script>
  <script src="metrics-framework.js"></script>
  <script src="discovery-core.js"></script>
  <script src="discovery.js"></script>
  
  <script>
    // Initialize performance and metrics frameworks
    const performanceManager = new MobilePerformanceManager();
    const uxMetrics = new UXMetricsFramework();
    
    // Enable metrics dashboard in development
    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
      document.getElementById('ux-metrics-dashboard').style.display = 'block';
    }
    
    console.log('🍣 Sushi Discovery PWA loaded with performance optimization and UX metrics');
    
    // Analytics toggle function
    function toggleAnalytics() {
      const footer = document.querySelector('.analytics-footer');
      const content = document.getElementById('analytics-content');
      const chevron = document.querySelector('.analytics-toggle .fa-chevron-up');
      
      footer.classList.toggle('collapsed');
      
      if (footer.classList.contains('collapsed')) {
        chevron.className = 'fas fa-chevron-up';
      } else {
        chevron.className = 'fas fa-chevron-down';
      }
    }
    
    // Make function globally available
    window.toggleAnalytics = toggleAnalytics;
  </script>
</body>
</html>

